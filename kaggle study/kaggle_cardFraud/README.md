# Kaggle Study
## 주제: Credit Card Fraud Detection
https://www.kaggle.com/mlg-ulb/creditcardfraud<br>
신용카드 회사의 사기성 신용 카드 거래를 인식하여 고객이 구입하지 않은 항목을 탐지해 요금을 부과하지 않게 하는 것이 목표이다.
<br>
<br>
## 데이터 설명
2013 년 9 월에 유럽 카드 소지자가 신용 카드로 거래 한 내용이 포함되어 있다.<br>
### 독립변수
- 설명변수 : Time(밀리세컨단위 시간),Amount(거래금액)외 V1,V2,...V28(28개) 숫자형 변수

<br>
<br>
### 종속변수
- 종속변수 : 이상(1)/정상(0)거래
  <br>
  설명변수를 활용해 종속변수를 분류(Classification)하는 Case
  <br>
  <br>
## 분석 방법
### 데이터셋의 특성
신용카드 거래내역의 이상거래 탐지 모델를 구축한다.
1%미만의 이상거래 불균형 데이터 셋이 주어지므로 평가지표에서 혼동 행렬 정확도는 의미가 없다.
(Speciticity특이도 값이 매우 작으므로 ROC곡선의 X축 False Positve Rate값은 항상 크다) 
따라서 결과지표는 f1 score 사용하도록 한다.((Recall & Precision 조화평균))
### 샘플링 방법
불균형 데이터를 다루는 방법에는 두 가지 전략이 있다. 분류 알고리즘을 향상하는 방법과 training data에서 클래스의 균형을 맞추는 방법이다. 보통 샘플링으로 문제를 접근하는 것이 선호되며 샘플링 방법에 따라 장단점이 존재한다.

#### Random Under Sampling
무작위로 다수 클래스의 예제를 제거하여 클래스 분포의 균형을 맞춘다.
- 장점 : 샘플의 수를 줄임으로써 공간,시간 문제를 개선할 수 있다.
- 단점 : 분류기를 만들 때 중요한 정보를 누락할 수 있다.
#### Random Over Sampling
소수 클래스의 인스턴스를 복사하여 수를 늘려서 균형을 맞춘다.
- 장점 : 정보의 손실이 없고 under sampling 보다 성능이 좋다.
- 단점 : 소수 클래스를 복사하므로 과적합의 가능성이 있다.
#### Cluster-Based Over Sampling
K-means알고리즘을 적용하여 소수/다수 인스턴스 클러스터로 구분하고 소수/다수 클러스터별 오버샘플링하여 인스턴스 균형을 맞춘다.
- 장점 : 클래스의 불균형을 해결하며, 클래스가 다른 서브 클러스터로 구성되어 있을 때의 불균형 문-제도 극복할 수 있다.
- 단점 : 과적합의 가능성이 있다.
#### SMOTE (Informed Over Sampling)
소수 클래스의 복제본이 더해짐으로써 발생되는 과적합을 피하는 기술
데이터의 부분집합과 소수 클래스로부터 새로운 소수 클래스 인스턴스가 만들어지면서 OverSampling 한다. 샘플의 기준으로 Knn을 이용한다.
- 장점 : 과적합 문제의 완화, 데이터 손실 없음
- 단점 : 근접의 예제를 생각하지 않기때문에 노이즈로 인한 클래스 겹침이 발생할 수 있다. 또한 고차원 데이터에서는 효과적이지 않을 수 있다.

### 모델링 방법
#### 랜덤포레스트
- recall: 0.89
- precision: 1.0
- f1 score: 0.94
#### GNB(나이브베이즈)
- recall: 0.91
- precision: 0.60
- f1 score: 0.72
#### SVM
- recall: 0.90
- precision: 0.95
- f1 score: 0.93
#### XGB
- recall   : 0.90
- precision: 0.97
- f1 score : 0.93
#### 인공신경망
- recall   : 0.97
- precision: 0.96
- f1 score : 0.96


## 최종 Score
모델링 평가 지표는 F1 Score(Recall & Precision 조화평균)으로 비교하였다.
비교 결과 인공신경망, 랜덤포레스트 모형이 이상거래 탐지에 있어서 우수한 성능을 보였다.

다층 인공신경망 모델에서는 불균형 데이터셋에 대한 Recall이 현저히 낮게 예측되어 샘플링(오버,SMOTE)를 통해 트레이닝의 종속변수의 비율을 조정하는게 유효하였다.
